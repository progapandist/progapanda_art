<%# Override the layout's overflow: hidden so the grid page is scrollable %>
<% content_for :head do %>
  <style>
    body, html {
      overflow: auto;
      background: #111;
    }

    .grid-nav {
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 0.75rem 1rem;
      background: rgba(17, 17, 17, 0.88);
      -webkit-backdrop-filter: blur(12px);
      backdrop-filter: blur(12px);
      color: #fff;
      font-family: 'Roboto Mono', monospace;
      font-size: 0.82rem;
      letter-spacing: 0.02em;
    }

    .grid-nav a {
      color: #fff;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      opacity: 0.65;
      transition: opacity 0.2s ease;
    }

    .grid-nav a:hover { opacity: 1; }

    .grid-nav .sep {
      opacity: 0.3;
    }

    .works-grid {
      columns: 3 280px;
      column-gap: 0;
      padding: 0;
    }

    .work-tile {
      break-inside: avoid;
      margin-bottom: 0;
      position: relative;
      overflow: hidden;
      display: block;
      background: #222;
      text-decoration: none;
    }

    .work-tile img {
      width: 100%;
      height: auto;
      display: block;
      transition: transform 0.4s ease;
    }

    .work-tile:hover img {
      transform: scale(1.04);
    }

    .work-tile-info {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 2rem 0.8rem 0.7rem;
      background: linear-gradient(to top, rgba(0, 0, 0, 0.72) 0%, rgba(0, 0, 0, 0) 100%);
      color: #fff;
      font-family: 'Roboto Mono', monospace;
      font-size: 0.75rem;
      line-height: 1.4;
      opacity: 0;
      transform: translateY(5px);
      transition: opacity 0.25s ease, transform 0.25s ease;
      pointer-events: none;
    }

    .work-tile:hover .work-tile-info {
      opacity: 1;
      transform: translateY(0);
    }

    .work-tile-title {
      display: block;
      font-weight: bold;
      font-size: 0.82rem;
      margin-bottom: 0.1rem;
    }

    .work-tile-meta {
      opacity: 0.8;
    }
  </style>
<% end %>

<nav class="grid-nav">
  <a href="<%= @return_path %>">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <polyline points="15 18 9 12 15 6"/>
    </svg>
    Gallery
  </a>
  <span class="sep">/</span>
  <span>All works (<%= @works.count %>)</span>
</nav>

<div class="works-grid">
  <% @works.each do |work| %>
    <% thumb_width, thumb_height = thumbnail_dimensions(work) %>
    <a href="<%= work_path(work.slug) %>" class="work-tile">
      <img
        src="<%= thumbnail_url(work) %>"
        alt="<%= work.title %>"
        loading="lazy"
        width="<%= thumb_width %>"
        height="<%= thumb_height %>"
      />
      <div class="work-tile-info">
        <span class="work-tile-title"><%= work.title %></span>
        <span class="work-tile-meta"><%= work.location %><%= ", #{work.year}" if work.year.present? %></span>
      </div>
    </a>
  <% end %>
</div>
